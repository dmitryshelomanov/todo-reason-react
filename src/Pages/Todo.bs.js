// Generated by BUCKLESCRIPT VERSION 4.0.3, PLEASE EDIT WITH CARE
'use strict';

var List = require("bs-platform/lib/js/list.js");
var $$Array = require("bs-platform/lib/js/array.js");
var Block = require("bs-platform/lib/js/block.js");
var Curry = require("bs-platform/lib/js/curry.js");
var React = require("react");
var ReasonReact = require("reason-react/src/ReasonReact.js");
var UniqId$ReactTemplate = require("../utils/UniqId.bs.js");
var TodoItem$ReactTemplate = require("../TodoItem.bs.js");

var component = ReasonReact.reducerComponent("root");

function make() {
  return /* record */[
          /* debugName */component[/* debugName */0],
          /* reactClassInternal */component[/* reactClassInternal */1],
          /* handedOffState */component[/* handedOffState */2],
          /* willReceiveProps */component[/* willReceiveProps */3],
          /* didMount */component[/* didMount */4],
          /* didUpdate */component[/* didUpdate */5],
          /* willUnmount */component[/* willUnmount */6],
          /* willUpdate */component[/* willUpdate */7],
          /* shouldUpdate */component[/* shouldUpdate */8],
          /* render */(function (param) {
              var send = param[/* send */3];
              var state = param[/* state */1];
              var len = String(List.length(state[/* todos */1]));
              var renderTodo = function (todo) {
                return ReasonReact.element(String(todo[/* id */0]), undefined, TodoItem$ReactTemplate.make(todo, (function (id) {
                                  return Curry._1(send, /* ToggleTodo */Block.__(1, [id]));
                                }), (function (id) {
                                  return Curry._1(send, /* RemoveTodo */Block.__(2, [id]));
                                }), /* array */[]));
              };
              var todosItem = $$Array.of_list(List.map(renderTodo, List.sort((function (prev, next) {
                              var match = !next[/* isChecked */1] && prev[/* isChecked */1];
                              if (match) {
                                return 1;
                              } else {
                                return 0;
                              }
                            }), state[/* todos */1])));
              var addNewTodo = function ($$event) {
                $$event.preventDefault();
                return Curry._1(send, /* AddTodo */Block.__(0, [state[/* todo */0]]));
              };
              var updateChar = function ($$event) {
                var value = $$event.target.value;
                return Curry._1(send, /* UpdateValue */Block.__(3, [value]));
              };
              return React.createElement("div", undefined, React.createElement("nav", {
                              className: "navbar navbar-dark bg-dark"
                            }, React.createElement("a", {
                                  className: "navbar-brand",
                                  href: "#"
                                }, "Simple Todo App"), React.createElement("span", {
                                  className: "navbar-text"
                                }, len + " items")), React.createElement("section", {
                              className: "container"
                            }, React.createElement("form", {
                                  onSubmit: addNewTodo
                                }, React.createElement("h2", undefined, "Todo title"), React.createElement("input", {
                                      className: "form-control",
                                      placeholder: "your todo",
                                      type: "text",
                                      value: state[/* todo */0],
                                      onChange: updateChar
                                    }), React.createElement("ul", {
                                      className: "list-group"
                                    }, todosItem))));
            }),
          /* initialState */(function () {
              return /* record */[
                      /* todo */"",
                      /* todos : [] */0
                    ];
            }),
          /* retainedProps */component[/* retainedProps */11],
          /* reducer */(function (action, state) {
              switch (action.tag | 0) {
                case 0 : 
                    return /* Update */Block.__(0, [/* record */[
                                /* todo */"",
                                /* todos : :: */[
                                  /* record */[
                                    /* id */UniqId$ReactTemplate.getUniqId(/* () */0),
                                    /* isChecked */false,
                                    /* title */action[0]
                                  ],
                                  state[/* todos */1]
                                ]
                              ]]);
                case 1 : 
                    var id = action[0];
                    var todos = List.map((function (todo) {
                            var match = todo[/* id */0] === id;
                            if (match) {
                              return /* record */[
                                      /* id */todo[/* id */0],
                                      /* isChecked */!todo[/* isChecked */1],
                                      /* title */todo[/* title */2]
                                    ];
                            } else {
                              return todo;
                            }
                          }), state[/* todos */1]);
                    return /* Update */Block.__(0, [/* record */[
                                /* todo */state[/* todo */0],
                                /* todos */todos
                              ]]);
                case 2 : 
                    var id$1 = action[0];
                    var todos$1 = List.filter((function (todo) {
                              return todo[/* id */0] !== id$1;
                            }))(state[/* todos */1]);
                    return /* Update */Block.__(0, [/* record */[
                                /* todo */state[/* todo */0],
                                /* todos */todos$1
                              ]]);
                case 3 : 
                    return /* Update */Block.__(0, [/* record */[
                                /* todo */action[0],
                                /* todos */state[/* todos */1]
                              ]]);
                
              }
            }),
          /* subscriptions */component[/* subscriptions */13],
          /* jsElementWrapped */component[/* jsElementWrapped */14]
        ];
}

exports.component = component;
exports.make = make;
/* component Not a pure module */
